{% from "form_field_macros.html" import render_field %}

<div class="form_multiform_wrapper">

  <!-- we need to add the current patient -->
  <div class="form_multiform form_multiform_self">
    <div class="multiform_content">
      <div class="multiform_content_readonly">
        <span class="multiform_item"><strong>{{ form.first_name.data }} {{ form.last_name.data }}</strong></span><br>
        <span class="multiform_item">DoB: {{ form.dob.data }}</span><br>
        <span class="multiform_item">SSN: {{ form.ssn.data }}</span><br>
        <span class="multiform_item multiform_item_description">Current Patient</span><br>
      </div>
    </div>
  </div>

  <!-- loop through each address and add a .form_multiform -->
  {% for entry in form.household_members %}
  <div class="form_multiform form_multiform_read">
    <div class="multiform_content">
      <div class="multiform_content_fields">
          <div class="form_row">
            {{ render_field(entry.full_name) }}
            {{ render_field(entry.dob, 
                            type="date",
                            max="2200-01-01",
                            min="1899-01-01"
            ) }}
            {{ render_field(entry.ssn,
                            placeholder="555-55-5555",
                            pattern="\d{3}-?\d{2}-?\d{4}"
            ) }}
          </div>
          {{ render_field(entry.relationship) }}
      </div>
      <div class="multiform_content_readonly">
        <span class="multiform_item"><strong>{{ entry.full_name.data }}</strong></span><br>
        <span class="multiform_item">DoB: {{ entry.dob.data }}</span><br>
        <span class="multiform_item">SSN: {{ entry.ssn.data }}</span><br>
        <span class="multiform_item multiform_item_description">{{ entry.relationship.data }}</span><br>
      </div>
    </div>
    <!-- form edit/remove controls -->
    <div class="multiform_controls">
      <button type="button" class="button button_brightgreen button_inverse multiform_control multiform_control_edit"><i class="fa fa-pencil"></i></button>
      <button type="button" class="button button_red button_inverse multiform_control multiform_control_remove"><i class="fa fa-trash"></i></button>
    </div>
  </div>
  {% endfor %}

  <!-- prepared form for user to enter -->
  {% with %}
    {% set entry = form.household_members.append_entry() %}
  <div class="form_multiform form_multiform_new" id="multiform_household_size">
    <div class="multiform_content">
      <div class="multiform_content_fields">
        <div class="row">
          {{ render_field(entry.full_name) }}
          {{ render_field(entry.dob, 
                          type="date",
                          max="2200-01-01",
                          min="1899-01-01"
          ) }}
          {{ render_field(entry.ssn,
                          placeholder="555-55-5555",
                          pattern="\d{3}-?\d{2}-?\d{4}"
          ) }}
        </div>
        {{ render_field(entry.relationship) }}
      </div>
    </div>
  </div>
  {% endwith %}

</div>

<button data-clone-id="multiform_household_size" class="button button_red button_small multiform_control_add">Add new household member <i class="fa fa-plus"></i></button>
<div class="cf"></div>

{{ render_field(form.filed_taxes_yn, ['an']) }}
{{ render_field(form.claimed_as_dependent_yn, ['an']) }}
